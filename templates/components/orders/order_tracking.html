<!-- Order Tracking Component -->
<div class="bg-white rounded-lg shadow-lg p-6 mb-6">
    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
        <div>
            <h3 class="text-xl font-semibold text-gray-900">Order Tracking</h3>
            <p class="text-sm text-gray-600">Order #{{ order.order_number }}</p>
        </div>
        {% if order.tracking_number %}
        <div class="text-right">
            <p class="text-sm text-gray-600">Tracking Number</p>
            <p class="font-mono text-sm font-medium">{{ order.tracking_number }}</p>
            {% if order.get_carrier_tracking_url %}
            <a href="{{ order.get_carrier_tracking_url }}" target="_blank" 
               class="text-xs text-blue-600 hover:text-blue-800 underline">
                Track with {{ order.carrier }}
            </a>
            {% endif %}
        </div>
        {% endif %}
    </div>

    <!-- Progress Bar -->
    <div class="mb-8">
        <div class="flex items-center justify-between mb-2">
            <span class="text-sm font-medium text-gray-700">Progress</span>
            <span class="text-sm text-gray-600">{{ order.tracking_percentage }}% Complete</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2">
            <div class="bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-500" 
                 style="width: {{ order.tracking_percentage }}%"></div>
        </div>
    </div>

    <!-- Tracking Stages -->
    <div class="space-y-4">
        {% for stage in order.tracking_stages %}
        <div class="flex items-start space-x-4">
            <!-- Icon -->
            <div class="flex-shrink-0">
                {% if stage.completed %}
                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                    {% if stage.icon == 'check-circle' %}
                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    {% elif stage.icon == 'cog' %}
                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                    </svg>
                    {% elif stage.icon == 'truck' %}
                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"></path>
                        <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1v-5a1 1 0 00-.293-.707L16 7.586A1 1 0 0015.414 7H14z"></path>
                    </svg>
                    {% elif stage.icon == 'home' %}
                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
                    </svg>
                    {% endif %}
                </div>
                {% else %}
                <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center">
                    {% if stage.icon == 'check-circle' %}
                    <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    {% elif stage.icon == 'cog' %}
                    <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                    </svg>
                    {% elif stage.icon == 'truck' %}
                    <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"></path>
                        <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1v-5a1 1 0 00-.293-.707L16 7.586A1 1 0 0015.414 7H14z"></path>
                    </svg>
                    {% elif stage.icon == 'home' %}
                    <svg class="w-5 h-5 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001 1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
                    </svg>
                    {% endif %}
                </div>
                {% endif %}
            </div>

            <!-- Content -->
            <div class="flex-1 min-w-0">
                <div class="flex items-center justify-between">
                    <p class="text-sm font-medium {% if stage.completed %}text-gray-900{% else %}text-gray-500{% endif %}">
                        {{ stage.title }}
                    </p>
                    {% if stage.timestamp %}
                    <p class="text-xs text-gray-500">
                        {{ stage.timestamp|date:"M d, Y g:i A" }}
                    </p>
                    {% endif %}
                </div>
                <p class="text-sm {% if stage.completed %}text-gray-600{% else %}text-gray-400{% endif %}">
                    {{ stage.description }}
                </p>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- LumaPrints Status Details -->
    {% if order.luma_prints_status %}
    <div class="mt-6 pt-6 border-t border-gray-200">
        <h4 class="text-sm font-medium text-gray-900 mb-3">Production Details</h4>
        <div class="bg-gray-50 rounded-lg p-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <p class="text-xs text-gray-600">LumaPrints Status</p>
                    <p class="text-sm font-medium text-gray-900">{{ order.luma_prints_status|title }}</p>
                </div>
                {% if order.luma_prints_updated_at %}
                <div>
                    <p class="text-xs text-gray-600">Last Updated</p>
                    <p class="text-sm font-medium text-gray-900">{{ order.luma_prints_updated_at|date:"M d, Y g:i A" }}</p>
                </div>
                {% endif %}
                {% if order.estimated_delivery %}
                <div>
                    <p class="text-xs text-gray-600">Estimated Delivery</p>
                    <p class="text-sm font-medium text-gray-900">{{ order.estimated_delivery|date:"M d, Y" }}</p>
                </div>
                {% endif %}
                {% if order.carrier %}
                <div>
                    <p class="text-xs text-gray-600">Shipping Carrier</p>
                    <p class="text-sm font-medium text-gray-900">{{ order.carrier }}</p>
                </div>
                {% endif %}
            </div>
            
            {% if order.luma_prints_tracking_url %}
            <div class="mt-4 pt-4 border-t border-gray-200">
                <a href="{{ order.luma_prints_tracking_url }}" target="_blank" 
                   class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                    </svg>
                    View Detailed Tracking
                </a>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Order Status Timeline -->
    {% if order.status_updates.exists %}
    <div class="mt-6 pt-6 border-t border-gray-200">
        <h4 class="text-sm font-medium text-gray-900 mb-3">Order History</h4>
        <div class="space-y-3">
            {% for update in order.status_updates.all %}
            <div class="flex items-start space-x-3">
                <div class="flex-shrink-0 w-2 h-2 bg-blue-400 rounded-full mt-2"></div>
                <div class="flex-1 min-w-0">
                    <p class="text-sm text-gray-900">
                        <span class="font-medium">{{ update.new_status|title }}</span>
                        <span class="text-gray-500">{{ update.timestamp|date:"M d, Y g:i A" }}</span>
                    </p>
                    {% if update.notes %}
                    <p class="text-xs text-gray-600 mt-1">{{ update.notes }}</p>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>